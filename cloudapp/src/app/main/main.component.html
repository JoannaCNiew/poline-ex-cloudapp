<app-topmenu></app-topmenu>

<div class="cloudapp-body">
    <div *ngIf="entities$ | async as entities">
        <ng-container *ngIf="entities.length > 0; then entitylist; else noentities"></ng-container>

        <!-- SZABLON: BRAK ENCJ -->
        <ng-template #noentities>
            <div class="cloudapp-body">
                <h1>Witaj!</h1>
                <p>Użyj tej przykładowej aplikacji, aby rozpocząć. Aby zobaczyć listę encji, przejdź do strony zawierającej listę rekordów w Almie (np. PO Line List).</p>
            </div>
        </ng-template>

        <!-- SZABLON: LISTA ENCJ (RADIOWE) -->
        <ng-template #entitylist>
            <div class="main-content">
                <div class="eca-actions">
                    <!-- PRZYCISKI DO CZYSZCZENIA/AKTUALIZACJI (zostawiamy, aby kompilacja działała) -->
                    <button mat-flat-button color="secondary" (click)="clear()" [disabled]="!selectedEntity">Wyczyść</button>
                </div>
                
                <h1>Encje</h1>

                <!-- WYNIK API (ukryty domyślnie) -->
                <mat-card [style.display]="selectedEntity ? '' : 'none'">
                    <mat-card-header><mat-card-title>Wybrana Encja</mat-card-title></mat-card-header>
                    <mat-card-content><pre>{{selectedEntity | json}}</pre></mat-card-content>
                </mat-card>
                <mat-card [style.display]="apiResult ? '' : 'none'">
                    <mat-card-header><mat-card-title>Wynik API</mat-card-title></mat-card-header>
                    <mat-card-content><textarea [value]="apiResult | json" readonly></textarea></mat-card-content>
                </mat-card>

                <!-- LISTA RADIO BUTTONS -->
                <label id="entities-radio-group-label">Wybierz encję:</label>
                <mat-radio-group aria-labelledby="entities-radio-group-label" class="entities-radio-group"
                    [(ngModel)]="selectedEntity" (change)="entitySelected($event)">
                    <mat-radio-button *ngFor="let entity of entities" [value]="entity">
                        {{entity.description}}
                    </mat-radio-button>
                </mat-radio-group>
            </div>
        </ng-template>
    </div>
</div>

<div class="loading-shade" *ngIf="loading">
  <mat-spinner diameter="50"></mat-spinner>
</div>
